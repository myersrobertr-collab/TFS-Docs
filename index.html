<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TFS Documents</title>

  <!-- PWA manifest -->
  <link rel="manifest" href="app.webmanifest" />

  <!-- üîß Single source of truth for version & manifest URL -->
  <script>
    window.APP_VERSION  = "2025.9.15";        /* ‚¨ÖÔ∏è bump this to bust caches */
    window.MANIFEST_URL = "docs/manifest.json";
  </script>

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#0b0f19" />

  <style>
    :root{
      --bg:#0b0f19; --card:#111827; --muted:#9ca3af; --text:#e5e7eb;
      --accent:#2563eb; --accent2:#e4002b; --ring:#334155;
      --btn:#1f2937; --btnText:#f9fafb;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;background:var(--bg);color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}

    .wrap{max-width:1100px;margin:0 auto;padding:16px 18px 40px}

    /* ===== Hero / banner ===== */
    .hero{
      display:flex;align-items:center;justify-content:space-between;gap:16px;
      padding:14px 16px;border:1px solid #1f2937;border-radius:14px;
      background:linear-gradient(180deg,#0f1626,#0b101a);
      box-shadow:0 12px 30px -24px rgba(0,0,0,.6);
    }
    .hero-left{min-width:0}
    .app-title{font-weight:800;letter-spacing:.2px;font-size:20px;margin:0 0 4px 0}
    .app-sub{font-size:13px;color:#9ca3af;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .ver-badge{
      display:inline-block;margin-left:.5rem;padding:.15rem .5rem;border-radius:8px;
      background:#0f172a;color:#cbd5e1;border:1px solid #334155;font-size:.75rem;
    }
    .hero-actions{flex:0 0 auto}

    .bar{margin:12px 0 8px;border-top:1px solid #1f2937}
    .tagbar{margin-bottom:6px;display:flex;flex-wrap:wrap;gap:8px}

    /* ===== chips ===== */
    .chip{
      display:inline-flex;align-items:center;gap:.35rem;
      padding:.28rem .6rem;border-radius:999px;background:#141a25;color:#cbd5e1;
      border:1px solid #243041;font-size:.85rem;cursor:pointer;
      transition:filter .12s ease, transform .12s ease;
      user-select:none;
    }
    .chip:hover{filter:brightness(1.08);transform:translateY(-1px)}
    .chip.active{background:#0f172a;color:#fff;border-color:#334155}

    /* ===== Grid & cards ===== */
    .section{margin:18px 0}
    .section h2{font-size:16px;margin:0 0 10px;color:#cbd5e1}
    .grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:14px}
    @media (max-width:900px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
    @media (max-width:560px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:14px;padding:14px}
    .card .desc{min-height:28px;margin-bottom:10px;color:var(--muted);font-size:13px}

    /* ===== Buttons (compact, stylish) ===== */
    .btn{
      display:block;width:100%;text-align:center;
      background:linear-gradient(180deg,#1f2937,#1b2432); color:var(--btnText);
      border:1px solid #273244;border-radius:10px;padding:10px 12px;
      font-weight:700;font-size:.95rem;text-decoration:none;letter-spacing:.2px;
      transition:transform .12s ease, box-shadow .12s ease, filter .12s ease;
      box-shadow:0 1px 0 rgba(255,255,255,.04) inset, 0 6px 14px -10px rgba(0,0,0,.6);
    }
    .btn:hover{transform:translateY(-1px);filter:brightness(1.06)}
    .btn:active{transform:translateY(0);filter:brightness(.98)}
    .btn:focus-visible{outline:none;box-shadow:0 0 0 2px #0b0f19,0 0 0 4px var(--accent)}
    .btn::after{content:"‚Üó";opacity:.6;margin-left:.45rem;font-weight:600}
    .btn.no-arrow::after{content:none}
    .btn.square{border-radius:8px;padding:.6rem .95rem;width:auto}

    /* Danger / EMER look */
    .btn.danger{
      background:linear-gradient(180deg,#e71f3b,#cf0f28);border-color:#cf0f28;color:#fff;
    }
    .section.emer h2{
      display:inline-block;padding:4px 10px;border-radius:10px;background:var(--accent2);color:#fff;
    }
    .card.emer{background:#161017;border-color:#e4002b80}

    /* ===== Offline overlay (progress) ===== */
    #dlOverlay[hidden]{display:none}
    #dlOverlay{
      position:fixed;inset:0;background:rgba(0,0,0,.5);backdrop-filter:saturate(120%) blur(4px);
      display:flex;align-items:center;justify-content:center;z-index:9999;
    }
    .dl-box{
      width:min(520px,90vw);background:#0e1522;border:1px solid #263243;border-radius:14px;padding:16px;
      box-shadow:0 18px 60px -30px rgba(0,0,0,.9)
    }
    .dl-title{font-weight:800;margin:0 0 8px 0}
    .dl-sub{font-size:13px;color:#9ca3af;margin-bottom:12px}
    .prog{height:10px;border-radius:999px;background:#101826;border:1px solid #233143;overflow:hidden}
    .fill{height:100%;width:0;background:linear-gradient(90deg,#2563eb,#22d3ee)}
    .dl-nums{display:flex;justify-content:space-between;font-size:12px;color:#9ca3af;margin-top:6px}

    /* Toast */
    #toast{position:fixed;left:50%;transform:translateX(-50%);bottom:14px;z-index:9998}
    .toast{
      background:#0f172a;border:1px solid #334155;color:#e5e7eb;border-radius:10px;
      padding:10px 12px;min-width:240px;box-shadow:0 18px 60px -30px rgba(0,0,0,.8)
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="hero">
      <div class="hero-left">
        <div class="app-title">üìÅ TFS Documents</div>
        <div class="app-sub">
          Works offline ¬∑ Manage in <code>docs/manifest.json</code>
          <span id="verChip" class="ver-badge"></span>
        </div>
      </div>
      <div class="hero-actions">
        <button id="offlineBtn" class="btn square no-arrow">Download for offline</button>
      </div>
    </header>

    <div class="bar"></div>

    <!-- tag chips render here -->
    <div id="tagbar" class="tagbar"></div>

    <!-- sections render here -->
    <div id="sections"></div>
  </div>

  <!-- offline download overlay -->
  <div id="dlOverlay" hidden>
    <div class="dl-box">
      <div class="dl-title">Caching documents for offline use‚Ä¶</div>
      <div class="dl-sub">You can keep flying; this will continue in the background.</div>
      <div class="prog"><div id="dlFill" class="fill"></div></div>
      <div class="dl-nums"><span id="dlCount">0 / 0</span><span id="dlPct">0%</span></div>
    </div>
  </div>

  <!-- toast container -->
  <div id="toast"></div>

  <!-- App script (reads APP_VERSION/MANIFEST_URL from window.*) -->
  <script src="app.js?v=__STAMP__"></script>
  <script>
    // Stamp cache-bust for the loader itself:
    (function(){
      const s = document.currentScript.previousElementSibling; // the app.js tag
      if (s && s.src.includes("__STAMP__")) {
        const v = encodeURIComponent(window.APP_VERSION || "dev");
        s.src = s.src.replace("__STAMP__", v);
      }
    })();
  </script>
</body>
</html>
